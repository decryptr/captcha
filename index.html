<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Completely Automated Public Turing test to tell 
  Computers and Humans Apart (Captchas) are tests designed to determine whether 
  the user is human. This package helps to create, visualize and solve text 
  based Captchas automatically. The package contains an extensible API so 
  anyone can contribute with new solutions.">
<title>Solve Text on Image Computer Vision Challenges • captcha</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Solve Text on Image Computer Vision Challenges">
<meta property="og:description" content="Completely Automated Public Turing test to tell 
  Computers and Humans Apart (Captchas) are tests designed to determine whether 
  the user is human. This package helps to create, visualize and solve text 
  based Captchas automatically. The package contains an extensible API so 
  anyone can contribute with new solutions.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">captcha</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/advanced.html">Advanced Usage</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/decryptr/captcha/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="captcha-">captcha <img src="reference/figures/hex_small.png" align="right"><a class="anchor" aria-label="anchor" href="#captcha-"></a>
</h1></div>
<!-- badges: start -->

<p>This package is an extensible API to build models and solve Captchas (Completely Automated Public Turing test to tell Computers and Humans Apart). It provides tools to read Captchas, visualize Captchas, annotate Captchas, fit models, and share fitted models.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>One can install the development version of <a href="https://github.com/decryptr/captcha" class="external-link">captcha</a> package running</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"decryptr/captcha"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="basic-usage">Basic usage<a class="anchor" aria-label="anchor" href="#basic-usage"></a>
</h2>
<p>The basic usage of <a href="https://github.com/decryptr/captcha" class="external-link">captcha</a> involves the functions <code><a href="reference/read_captcha.html">read_captcha()</a></code>, <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>, <code><a href="reference/captcha_annotate.html">captcha_annotate()</a></code>, <code><a href="reference/models.html">captcha_load_model()</a></code> and <code><a href="reference/decrypt.html">decrypt()</a></code>. The diagram below summarizes the relationships between these functions. The arrows indicate the dependency of functions on objects generated by other functions.</p>
<p><img src="reference/figures/diagram.png" width="100%" style="display: block; margin: auto;"></p>
<div class="section level3">
<h3 id="read-and-visualize">Read and visualize<a class="anchor" aria-label="anchor" href="#read-and-visualize"></a>
</h3>
<p>The <code><a href="reference/read_captcha.html">read_captcha()</a></code> function reads a character vector of image files and stores them in memory. Behind the scenes, the function uses the <a href="https://docs.ropensci.org/magick/" class="external-link"><code>{magick}</code></a> package to deal with the types of files that may appear (JPEG, PNG, among others).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/decryptr/captcha" class="external-link">captcha</a></span><span class="op">)</span></span>
<span><span class="va">example</span> <span class="op">&lt;-</span> <span class="st">"man/figures/dados_tjmg.jpeg"</span></span>
<span><span class="va">captcha</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read_captcha.html">read_captcha</a></span><span class="op">(</span><span class="va">example</span><span class="op">)</span></span>
<span></span>
<span><span class="va">captcha</span></span>
<span><span class="co">#&gt;   format width height colorspace matte filesize density</span></span>
<span><span class="co">#&gt; 1   JPEG   100     50       sRGB FALSE     4530   72x72</span></span></code></pre></div>
<p><img src="reference/figures/fig-example-plot-inicial-1.png" width="30%" style="display: block; margin: auto;"></p>
<p>The function returns an object of class <code>captcha</code>, which can be used by other methods.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">captcha</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "captcha"</span></span></code></pre></div>
<p>The captcha object is a list with three elements: <code>$img</code>, which contains the image read from the <a href="https://docs.ropensci.org/magick/" class="external-link">magick</a> package; <code>$lab</code>, which contains the image label (by default, <code>NULL</code>); and <code>$path</code>, which contains the path of the image.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">captcha</span><span class="op">)</span></span>
<span><span class="co">#&gt; Class 'captcha'  hidden list of 3</span></span>
<span><span class="co">#&gt;  $ img :Class 'magick-image' &lt;externalptr&gt; </span></span>
<span><span class="co">#&gt;  $ lab : NULL</span></span>
<span><span class="co">#&gt;  $ path: chr "man/figures/dados_tjmg.jpeg"</span></span></code></pre></div>
<p>The <code><a href="reference/read_captcha.html">read_captcha()</a></code> function has an <code>lab_in_path=</code> parameter, which indicates whether the image path contains the label. If <code>lab_in_path=TRUE</code>, the function will try to extract the label from the file (getting the text that comes after the last <code>_</code> of the path) and store it in the <code>$lab</code> element.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example</span> <span class="op">&lt;-</span> <span class="st">"man/figures/mnist128c49c36e13_6297.png"</span></span>
<span><span class="va">captcha</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read_captcha.html">read_captcha</a></span><span class="op">(</span><span class="va">example</span>, lab_in_path <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">captcha</span><span class="op">)</span></span>
<span><span class="co">#&gt; Class 'captcha'  hidden list of 3</span></span>
<span><span class="co">#&gt;  $ img :Class 'magick-image' &lt;externalptr&gt; </span></span>
<span><span class="co">#&gt;  $ lab : chr "6297"</span></span>
<span><span class="co">#&gt;  $ path: chr "man/figures/mnist128c49c36e13_6297.png"</span></span></code></pre></div>
<p>The <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function is a method of <a href="https://adv-r.hadley.nz/s3.html" class="external-link">class S3</a> from base R. The function facilitates the visualization of Captchas. The function receives a list of images (obtained with the <code><a href="reference/read_captcha.html">read_captcha()</a></code> function) and displays the Captcha visually.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example</span> <span class="op">&lt;-</span> <span class="st">"man/figures/dados_tjmg.jpeg"</span></span>
<span><span class="va">captcha</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read_captcha.html">read_captcha</a></span><span class="op">(</span><span class="va">example</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">captcha</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/fig-example-plot-1.png" width="30%" style="display: block; margin: auto;"></p>
<p>An interesting aspect of the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function is that it deals with a list of Captchas. It is useful when the goal is to view several Captchas in the image simultaneously. The next image shows an example.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">examples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"man/figures/"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"dados_tjmg.jpeg"</span>,</span>
<span>  <span class="st">"dados_esaj.png"</span>,</span>
<span>  <span class="st">"dados_rfb.png"</span>,</span>
<span>  <span class="st">"dados_sei.png"</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">captchas</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read_captcha.html">read_captcha</a></span><span class="op">(</span><span class="va">examples</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">captchas</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/fig-example-plot-multi-1.png" width="70%" height="100px" style="display: block; margin: auto;"></p>
<p>By default, the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function arranges the images into four columns. To change the default, one can modify the options using <code>options(captcha.print.cols = N)</code>, where <code>N</code> is the desired number of columns. The next image shows an example with two columns.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>captcha.print.cols <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">captchas</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/fig-example-plot-multi-2col-1.png" width="60%" style="display: block; margin: auto;"></p>
<p>When the list of Captchas is too long, the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function displays a maximum number of images accompanied by a message. By default, this number is 100, with 25 rows and four columns. One can override the option by combining the <code>captcha.print.cols=</code> and <code>captcha.print.rows=</code> options. The next image shows an example of the function’s behavior when the number of images exceeds 100.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># more than 100 imagens:</span></span>
<span><span class="va">examples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"man/figures/dados_tjmg.jpeg"</span>, <span class="fl">110</span><span class="op">)</span></span>
<span><span class="va">captchas</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read_captcha.html">read_captcha</a></span><span class="op">(</span><span class="va">examples</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">captchas</span><span class="op">)</span></span>
<span><span class="co">#&gt; ℹ Too many images, printing first 100. To override, run</span></span>
<span><span class="co">#&gt; • options('captcha.print.rows' = MAX_ROWS)</span></span>
<span><span class="co">#&gt; • options('captcha.print.cols' = COLUMNS)</span></span></code></pre></div>
<p><img src="reference/figures/fig-example-plot-multi-many-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>It is possible to create subsets of <code>captcha</code> objects using the <code>[</code> operator. One can also use the <code><a href="https://rdrr.io/r/base/length.html" class="external-link">length()</a></code> function to measure the number of images. The next image shows an example of these operations.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">captchas_subset</span> <span class="op">&lt;-</span> <span class="va">captchas</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">captchas_subset</span><span class="op">)</span> <span class="co"># 20</span></span>
<span><span class="co">#&gt; [1] 20</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">captchas_subset</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/fig-example-plot-multi-many-subset-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>Finally, when the image has a label, the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function shows the label on the corner of the image. The following image shows an example.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example</span> <span class="op">&lt;-</span> <span class="st">"man/figures/mnist128c49c36e13_6297.png"</span></span>
<span><span class="va">captcha</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read_captcha.html">read_captcha</a></span><span class="op">(</span><span class="va">example</span>, lab_in_path <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">captcha</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/fig-example-plot-rotulado-1.png" width="30%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="annotate">Annotate<a class="anchor" aria-label="anchor" href="#annotate"></a>
</h3>
<p>The <code><a href="reference/captcha_annotate.html">captcha_annotate()</a></code> function annotates a Captcha image, either manually or automatically. It modifies the image path and adds the text <code>_label</code> to the end of the file path. The function has the following parameters:</p>
<ul>
<li>
<code>files=</code>: object of class captcha read with function <code><a href="reference/read_captcha.html">read_captcha()</a></code> (recommended) or character vector of file paths.</li>
<li>
<code>labels=</code>: (optional) character vector with image labels. It must have the same <code><a href="https://rdrr.io/r/base/length.html" class="external-link">length()</a></code> as <code>files=</code>. The value is <code>NULL</code> by default, prompting the user to enter the label manually.</li>
<li>
<code>path=</code>: (optional) path of the folder to save the annotated files. By default, it saves files with modified names in the same folder as the original files.</li>
<li>
<code>rm_old=</code>: (optional) whether or not to delete the original files. Defaults to <code>FALSE</code>.</li>
</ul>
<p>The <code><a href="reference/captcha_annotate.html">captcha_annotate()</a></code> function returns a vector with the paths of the modified files. The <code>labels=</code> parameter can handle situations where one knows the Captcha label. For example, a workflow that uses an oracle might provide the label automatically.</p>
<p>When the label doesn’t exist, the <code><a href="reference/captcha_annotate.html">captcha_annotate()</a></code> function opens the prompt for classification and shows the image using <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>. The following image shows an application example of the <code><a href="reference/captcha_annotate.html">captcha_annotate()</a></code> function in <a href="https://posit.co/download/rstudio-desktop/" class="external-link">RStudio</a>.</p>
<p><img src="reference/figures/exemplo_classify.png" width="70%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="predict">Predict<a class="anchor" aria-label="anchor" href="#predict"></a>
</h3>
<p>The <code><a href="reference/decrypt.html">decrypt()</a></code> function returns a label for an image using a fitted model. The function takes two arguments: <code>file=</code>, which can be either the file path or a captcha class object, and <code>model=</code>, which contains an object of class luz_module_fitted, fitted using the <a href="https://mlverse.github.io/luz/" class="external-link">{luz}</a> package.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/models.html">captcha_load_model</a></span><span class="op">(</span><span class="st">"cadesp"</span><span class="op">)</span></span>
<span><span class="va">img</span> <span class="op">&lt;-</span> <span class="st">"man/figures/dados_cadesp.jpg"</span></span>
<span><span class="va">captcha</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read_captcha.html">read_captcha</a></span><span class="op">(</span><span class="va">img</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">captcha</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/fig-example-decrypt-1.png" width="30%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/decrypt.html">decrypt</a></span><span class="op">(</span><span class="va">captcha</span>, <span class="va">model</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "dwyy"</span></span></code></pre></div>
<p>There are fitted models for several different Captchas available in the captcha package. It is possible to load a trained model using the <code><a href="reference/models.html">captcha_load_model()</a></code> function. The <code>path=</code> parameter contains either the path for a fitted model or a string with the name of a released model, like <code>"rfb"</code>. Fitted models are stored in the <a href="https://github.com/decryptr/captcha" class="external-link">captcha</a> package repository releases, which can be downloaded using the <a href="https://docs.ropensci.org/piggyback/" class="external-link"><code>{piggyback}</code> package</a> package.</p>
<p>Currently, the Captchas with available fitted models are <code>trf5</code>, <code>tjmg</code>, <code>trt</code>, <code>esaj</code>, <code>jucesp</code>, <code>tjpe</code>, <code>tjrs</code>, <code>cadesp</code>, <code>sei</code> and <code>rfb</code>. The table below describes the models and their accuracy.</p>
<table class="table">
<colgroup>
<col width="6%">
<col width="40%">
<col width="44%">
<col width="8%">
</colgroup>
<thead><tr class="header">
<th align="left">Name</th>
<th align="left">Example</th>
<th align="left">Description</th>
<th align="right">Accuracy</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">cadesp</td>
<td align="left"><img src="reference/figures/dados_cadesp.jpg" alt="Captcha cadesp"></td>
<td align="left">Centro de Apoio ao Desenvolvimento da Saúde Pública</td>
<td align="right">96.37%</td>
</tr>
<tr class="even">
<td align="left">esaj</td>
<td align="left"><img src="reference/figures/dados_esaj.png" alt="Captcha esaj"></td>
<td align="left">Tribunal de Justiça da Bahia</td>
<td align="right">94.50%</td>
</tr>
<tr class="odd">
<td align="left">jucesp</td>
<td align="left"><img src="reference/figures/dados_jucesp.jpg" alt="Captcha jucesp"></td>
<td align="left">Junta Comercial de São Paulo</td>
<td align="right">89.88%</td>
</tr>
<tr class="even">
<td align="left">rfb</td>
<td align="left"><img src="reference/figures/dados_rfb.png" alt="Captcha rfb"></td>
<td align="left">Receita Federal</td>
<td align="right">95.70%</td>
</tr>
<tr class="odd">
<td align="left">sei</td>
<td align="left"><img src="reference/figures/dados_sei.png" alt="Captcha sei"></td>
<td align="left">Sistema Eletrônico de Informações - ME</td>
<td align="right">77.25%</td>
</tr>
<tr class="even">
<td align="left">tjmg</td>
<td align="left"><img src="reference/figures/dados_tjmg.jpeg" alt="Captcha tjmg"></td>
<td align="left">Tribunal de Justiça de Minas Gerais</td>
<td align="right">98.35%</td>
</tr>
<tr class="odd">
<td align="left">tjpe</td>
<td align="left"><img src="reference/figures/dados_tjpe.png" alt="Captcha tjpe"></td>
<td align="left">Tribunal de Justiça de Pernambuco</td>
<td align="right">91.88%</td>
</tr>
<tr class="even">
<td align="left">tjrs</td>
<td align="left"><img src="reference/figures/dados_tjrs.jpg" alt="Captcha tjrs"></td>
<td align="left">Tribunal de Justiça do Rio Grande do Sul</td>
<td align="right">99.57%</td>
</tr>
<tr class="odd">
<td align="left">trf5</td>
<td align="left"><img src="reference/figures/dados_trf5.jpg" alt="Captcha trf5"></td>
<td align="left">Tribunal Regional Federal 5</td>
<td align="right">98.77%</td>
</tr>
<tr class="even">
<td align="left">trt</td>
<td align="left"><img src="reference/figures/dados_trt.jpeg" alt="Captcha trt"></td>
<td align="left">Tribunal Regional do Trabalho 3</td>
<td align="right">98.50%</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="fit-custom-model">Fit custom model<a class="anchor" aria-label="anchor" href="#fit-custom-model"></a>
</h3>
<p>The <a href="https://github.com/decryptr/captcha" class="external-link">captcha</a> package provides a basic interface for fitting custom models from a fully labeled data. Annotation can be done manually using the <code><a href="reference/captcha_annotate.html">captcha_annotate()</a></code> function presented earlier or with another method developed by the user. The model uses a convolutional neural network architecture, similar to the <a href="https://en.wikipedia.org/wiki/LeNet" class="external-link">LeNet-5 model</a>.</p>
<p>The modeling step has some assumptions about the file names. Images must be in a folder and have the pattern <code>path/to/file/&lt;id&gt;_&lt;lab&gt;.&lt;ext&gt;</code>, where:</p>
<ul>
<li>
<code>&lt;id&gt;</code>: can be any name, preferably without accents or other special characters, to avoid encoding issues. It usually contains a name for the type and a hash to identify the image uniquely. <strong>Note</strong>: When annotating a file, the id must be unique, as two Captchas can have the same label.</li>
<li>
<code>&lt;lab&gt;</code>: is the Captcha label. It is a string of characters between <code>[a-zA-Z0-9]</code>, which can be case-sensitive if necessary. All labels must have the same length.</li>
<li>
<code>&lt;ext&gt;</code>: file extension. It can be <code>.png</code>, <code>.jpeg</code> or <code>.jpg</code>. The operations also work for the <code>.svg</code> format, but it may have problems due to the image’s transparency.</li>
</ul>
<p>The <code><a href="reference/captcha_fit_model.html">captcha_fit_model()</a></code> function fits a model from a folder with annotated images. The function considers the parameters:</p>
<ul>
<li>
<code>dir=</code>: the path of the annotated files;</li>
<li>
<code>dir_valid=</code>: (optional) the path of annotated files for validation;</li>
<li>
<code>prop_valid</code>=:, the proportion of the training set to be considered as validation. <code>prop_valid=</code> is ignored when <code>dir_valid=</code> is given (by default, 20% of the dataset is considered as validation).</li>
</ul>
<p>The <code><a href="reference/captcha_fit_model.html">captcha_fit_model()</a></code> function also has some parameters related to the neural network. They are:</p>
<ul>
<li>
<code>dropout=</code>: the dropout percentage applied to the hidden layers of the network (by default, 0.25);</li>
<li>
<code>dense_units=</code>: the number of units in the hidden layer that comes after the convolutional layers (by default, 200);</li>
<li>
<code>decay=</code>: the learning rate decay percentage (by default, 0.99);</li>
<li>
<code>epochs=</code>: the number of epochs to fit the model (by default, 100).</li>
</ul>
<p>An important note is that the model stops fitting after 20 iterations without significant increment of accuracy (chosen as 1%; for more details, see the <a href="https://decryptr.github.io/captcha/articles/advanced.html">advanced guide</a>).</p>
<p>The function returns a fitted model of class <code>luz_module_fitted</code>, which can be saved to disk using <code>luz_save()</code>. One can also serialize the model to use it with other packages such as PyTorch. A tutorial on serialization can be found in the <a href="https://torch.mlverse.org/docs/articles/serialization.html" class="external-link">torch package documentation</a>.</p>
<p>Fitting a new Captcha model can be challenging. To help with that, the <a href="https://github.com/decryptr/captcha" class="external-link">captcha</a> package documentation provides an <a href="">application example</a>. The example uses Captchas from <code><a href="reference/captcha_generate.html">captcha_generate()</a></code> function, which generates Captchas using the <a href="https://docs.ropensci.org/magick/" class="external-link">magick</a> package. The <code><a href="reference/captcha_generate.html">captcha_generate()</a></code> function has the following parameters:</p>
<ul>
<li>
<code>write_disk=</code>: save files to disk? By default, <code>FALSE</code>.</li>
<li>
<code>path=</code>: Path to save files on disk, if the previous parameter is <code>TRUE</code>.</li>
<li>
<code>chars=</code>: Which characters to use in the image.</li>
<li>
<code>n_chars=</code>: The length of the Captcha.</li>
<li>
<code>n_rows=</code>: Height of the image, in pixels.</li>
<li>
<code>n_cols=</code>: Width of the image, in pixels.</li>
<li>
<code>p_rotate=</code>: Probability of image rotation.</li>
<li>
<code>p_line=</code>: Probability of adding a line between the letters.</li>
<li>
<code>p_stroke=</code>: Probability of adding a border to the letters.</li>
<li>
<code>p_box=</code>: Probability of adding a box (rectangle) around the letters.</li>
<li>
<code>p_implode=</code>: Probability of adding implode effects.</li>
<li>
<code>p_oilpaint=</code>: Probability to add oil paint effects.</li>
<li>
<code>p_noise=</code>: Probability of adding white noise to the background of the image.</li>
<li>
<code>p_lat=</code>: Probability of applying the <em>local adaptive thresholding</em> algorithm to the image.</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="advanced-usage">Advanced usage<a class="anchor" aria-label="anchor" href="#advanced-usage"></a>
</h2>
<p>Once the premises of the classified base are met, it is possible to fit a neural network model using the <a href="https://github.com/decryptr/captcha" class="external-link">captcha</a> package. However, the training step involves many small adaptations, it was decided to export functions in two depth levels. To address that, the <a href="https://github.com/decryptr/captcha" class="external-link">captcha</a> package also provides a <strong>procedural</strong> approach to fit the model, using a step-by-step described in the <a href="https://decryptr.github.io/captcha/articles/advanced.html">advanced guide</a>.</p>
</div>
<div class="section level2">
<h2 id="contributing">Contributing<a class="anchor" aria-label="anchor" href="#contributing"></a>
</h2>
<p>One can contribute to the package through <a href="https://github.com/decryptr/captcha/pulls" class="external-link">pull requests</a> and report problems or ask questions at the <a href="https://github.com/decryptr/captcha/issues" class="external-link">issues section</a>. See the CONTRIBUTING.md file for detailed instructions.</p>
</div>
<div class="section level2">
<h2 id="code-of-conduct">Code of Conduct<a class="anchor" aria-label="anchor" href="#code-of-conduct"></a>
</h2>
<p>Please note that the captcha project is released with a <a href="https://decryptr.github.io/captcha/CODE_OF_CONDUCT.html">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>MIT</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/decryptr/captcha/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/decryptr/captcha/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing captcha</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Julio Trecenti <br><small class="roles"> Maintainer, author </small> <a href="https://orcid.org/0000-0002-1680-6389" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="https://img.shields.io/badge/lifecycle-stable-brightgreen.svg" alt="Lifecycle: stable"></a></li>
<li><a href="https://app.codecov.io/gh/decryptr/captcha?branch=master" class="external-link"><img src="https://codecov.io/gh/decryptr/captcha/branch/master/graph/badge.svg" alt="Code coverage"></a></li>
<li><a href="https://github.com/decryptr/captcha/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/decryptr/captcha/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://CRAN.R-project.org/package=captcha" class="external-link"><img src="https://www.r-pkg.org/badges/version/captcha" alt="CRAN status"></a></li>
<li><a href="https://joss.theoj.org/papers/027aba13cdc52465145959e84637bd56" class="external-link"><img src="https://joss.theoj.org/papers/027aba13cdc52465145959e84637bd56/status.svg" alt="status"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Julio Trecenti.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
